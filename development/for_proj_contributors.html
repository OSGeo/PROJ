

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Development rules and tools for PROJ code contributors &mdash; PROJ.4 5.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PROJ.4 5.0.0 documentation" href="../index.html"/>
        <link rel="up" title="Development" href="index.html"/>
        <link rel="next" title="FAQ" href="../faq.html"/>
        <link rel="prev" title="Version 4 to 5 API Migration" href="migration.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PROJ.4
          

          
          </a>

          
            
            
              <div class="version">
                5.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/index.html">Using PROJ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apps/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations/index.html">Coordinate operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resource_files.html">Resource files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geodesic.html">Geodesic calculations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Quick start</a></li>
<li class="toctree-l2"><a class="reference internal" href="transformations.html">Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="errorhandling.html">Error handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="threads.html">Threads</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/index.html">Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmake.html">Using PROJ in CMake projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="bindings.html">Language bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration.html">Version 4 to 5 API Migration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Development rules and tools for PROJ code contributors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#code-contributions">Code contributions.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#making-changes">Making Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submitting-changes">Submitting Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#coding-conventions">Coding conventions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tools">Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cppcheck-static-analyzer">cppcheck static analyzer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clang-static-analyzer-csa">CLang Static Analyzer (CSA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#typo-detection-and-fixes">Typo detection and fixes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PROJ.4</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Development</a> &raquo;</li>
        
      <li>Development rules and tools for PROJ code contributors</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="development-rules-and-tools-for-proj-code-contributors">
<span id="for-proj-contributors"></span><h1>Development rules and tools for PROJ code contributors<a class="headerlink" href="#development-rules-and-tools-for-proj-code-contributors" title="Permalink to this headline">¶</a></h1>
<p>This is a guide for PROJ, casual or regular, code contributors.</p>
<div class="section" id="code-contributions">
<h2>Code contributions.<a class="headerlink" href="#code-contributions" title="Permalink to this headline">¶</a></h2>
<p>Code contributions can be either bug fixes or new features. The process
is the same for both, so they will be discussed together in this
section.</p>
<div class="section" id="making-changes">
<h3>Making Changes<a class="headerlink" href="#making-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Create a topic branch from where you want to base your work.</li>
<li>You usually should base your topic branch off of the master branch.</li>
<li>To quickly create a topic branch: <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">my-topic-branch</span></code></li>
<li>Make commits of logical units.</li>
<li>Check for unnecessary whitespace with <code class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span> <span class="pre">--check</span></code> before
committing.</li>
<li>Make sure your commit messages are in the <a class="reference external" href="http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">proper
format</a>.</li>
<li>Make sure you have added the necessary tests for your changes.</li>
<li>Make sure that all tests pass</li>
</ul>
</div>
<div class="section" id="submitting-changes">
<h3>Submitting Changes<a class="headerlink" href="#submitting-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Push your changes to a topic branch in your fork of the repository.</li>
<li>Submit a pull request to the PROJ repository in the OSGeo
organization.</li>
<li>If your pull request fixes/references an issue, include that issue
number in the pull request. For example:</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Wiz</span> <span class="n">the</span> <span class="n">bang</span>

<span class="n">Fixes</span> <span class="c1">#123.</span>
</pre></div>
</div>
<ul class="simple">
<li>PROJ developers will look at your patch and take an appropriate
action.</li>
</ul>
</div>
<div class="section" id="coding-conventions">
<h3>Coding conventions<a class="headerlink" href="#coding-conventions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="programming-language">
<h4>Programming language<a class="headerlink" href="#programming-language" title="Permalink to this headline">¶</a></h4>
<p>PROJ is developed strictly in ANSI C 89.</p>
</div>
<div class="section" id="coding-style">
<h4>Coding style<a class="headerlink" href="#coding-style" title="Permalink to this headline">¶</a></h4>
<p>We don&#8217;t enforce any particular coding style, but please try to keep it
as simple as possible. If improving existing code, please try to conform
with the style of the locally surrounding code.</p>
</div>
<div class="section" id="whitespace">
<h4>Whitespace<a class="headerlink" href="#whitespace" title="Permalink to this headline">¶</a></h4>
<p>Throughout the PROJ code base you will see differing whitespace use.
The general rule is to keep whitespace in whatever form it is in the
file you are currently editing. If the file has a mix of tabs and space
please convert the tabs to space in a separate commit before making any
other changes. This makes it a lot easier to see the changes in diffs
when evaluating the changed code. New files should use spaces as
whitespace.</p>
</div>
<div class="section" id="file-names">
<h4>File names<a class="headerlink" href="#file-names" title="Permalink to this headline">¶</a></h4>
<p>Files in which projections are implemented are prefixed with an
upper-case <code class="docutils literal"><span class="pre">PJ_</span></code> and most other files are prefixed with lower-case
<code class="docutils literal"><span class="pre">pj_</span></code>. Some file deviate from this pattern, most of them dates back to
the very early releases of PROJ. New contributions should follow the
pj-prefix pattern. Unless there are obvious reasons not to.</p>
</div>
</div>
</div>
<div class="section" id="tools">
<h2>Tools<a class="headerlink" href="#tools" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cppcheck-static-analyzer">
<h3>cppcheck static analyzer<a class="headerlink" href="#cppcheck-static-analyzer" title="Permalink to this headline">¶</a></h3>
<p>You can run locally <code class="docutils literal"><span class="pre">scripts/cppcheck.sh</span></code> that is a wrapper script around the
cppcheck utility. It is known to work with cppcheck 1.61 of Ubuntu Trusty 14.0,
since this is what is currently used on Travis-CI
(<code class="docutils literal"><span class="pre">travis/linux_gcc/before_install.sh</span></code>).
At the time of writing, this also works with cppcheck 1.72 of Ubuntu Xenial
16.04, and latest cppcheck
master.</p>
<p>cppcheck can have false positives. In general, it is preferable to rework the
code a bit to make it more &#8216;obvious&#8217; and avoid those false positives. When not
possible, you can add a comment in the code like</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/*</span> <span class="n">cppcheck</span><span class="o">-</span><span class="n">suppress</span> <span class="n">duplicateBreak</span> <span class="o">*/</span>
</pre></div>
</div>
<p>in the preceding line. Replace
duplicateBreak with the actual name of the violated rule emitted by cppcheck.</p>
</div>
<div class="section" id="clang-static-analyzer-csa">
<h3>CLang Static Analyzer (CSA)<a class="headerlink" href="#clang-static-analyzer-csa" title="Permalink to this headline">¶</a></h3>
<p>CSA is run by the <code class="docutils literal"><span class="pre">travis/csa</span></code> build configuration. You may also run it locally.</p>
<p>Preliminary step: install clang. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">releases</span><span class="o">.</span><span class="n">llvm</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">clang</span><span class="o">+</span><span class="n">llvm</span><span class="o">-</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">14.04</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="n">tar</span> <span class="n">xJf</span> <span class="n">clang</span><span class="o">+</span><span class="n">llvm</span><span class="o">-</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">14.04</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
</pre></div>
</div>
<p>Run configure under the scan-build utility of clang:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">clang</span><span class="o">+</span><span class="n">llvm</span><span class="o">-</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">14.04</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">scan</span><span class="o">-</span><span class="n">build</span> <span class="o">./</span><span class="n">configure</span>
</pre></div>
</div>
<p>Build under scan-build:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">clang</span><span class="o">+</span><span class="n">llvm</span><span class="o">-</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">14.04</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">scan</span><span class="o">-</span><span class="n">build</span> <span class="n">make</span> <span class="p">[</span><span class="o">-</span><span class="n">j8</span><span class="p">]</span>
</pre></div>
</div>
<p>If CSA finds errors, they will be emitted during the build. And in which case,
at the end of the build process, scan-build will emit a warning message
indicating errors have been found and how to display the error report. This
is with someling like</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">clang</span><span class="o">+</span><span class="n">llvm</span><span class="o">-</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">14.04</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">scan</span><span class="o">-</span><span class="n">view</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">scan</span><span class="o">-</span><span class="n">build</span><span class="o">-</span><span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">15</span><span class="o">-</span><span class="mi">121416</span><span class="o">-</span><span class="mi">17476</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>This will open a web browser with the interactive report.</p>
<p>CSA may also have false positives. In general, this happens when the code is
non-trivial / makes assumptions that hard to check at first sight. You will
need to add extra checks or rework it a bit to make it more &#8220;obvious&#8221; for CSA.
This will also help humans reading your code !</p>
</div>
<div class="section" id="typo-detection-and-fixes">
<h3>Typo detection and fixes<a class="headerlink" href="#typo-detection-and-fixes" title="Permalink to this headline">¶</a></h3>
<p>Run <code class="docutils literal"><span class="pre">scripts/fix_typos.sh</span></code></p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../faq.html" class="btn btn-neutral float-right" title="FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="migration.html" class="btn btn-neutral" title="Version 4 to 5 API Migration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 1983-2018.
      Last updated on 29 Mar 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'5.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>